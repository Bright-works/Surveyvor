<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:c="http://java.sun.com/jsp/jstl/core"	
    >
<ui:composition template="../layouts/layout.xhtml">
	<ui:define name="titre">Résultats</ui:define>
	<ui:define name="content">
		<section class="content-header">
          <h4>
            Résultats de sondage 
            <small>Surveyvor</small>
          </h4>
     	</section>
     	<h:form>
			<section class="content">
				<!-- sondage informations -->
				<div class="box box-default" style="text-align: center;">
					<div class="box-header with-border" >
						<h3><h:outputText value="#{surveyBean.selected.title}"/></h3>
					</div>
					<div class="box-body">
						<p:outputLabel value="#{surveyBean.selected.description}"/>
					</div>
				</div>
				<!-- data table -->
				<div class="box box-default" style="text-align: center;">
					<div class="box-header with-border" >
					
					<c:if test="#{surveyBean.selected.type eq 'REPARTITION'}">
						<p:dataTable rows="15" selectionMode="single" paginatorAlwaysVisible="false" paginator="true"
						emptyMessage="Aucun résultat généré" editable="true" >
							<f:facet name="header">
								Liste des participations
							</f:facet>
							    <f:facet name="footer">
						            <h:commandLink>
						                <p:graphicImage library="img" name="/pdf-icon.png" width="30"/>
						                <p:dataExporter type="pdf" target="tbl" fileName="sondage#{surveyBean.selected.id}" />
						            </h:commandLink>
						            <p:spacer height="0" width="10px"/>
						            <h:commandLink>
						                <p:graphicImage library="img" name="/excel_icon.png" width="30"/>
						                <p:dataExporter type="xls" target="tbl" fileName="sondage#{surveyBean.selected.id}" />
						            </h:commandLink>
						        </f:facet>
							<p:column headerText="Nom" exportable="true">
								<h:outputText />
							</p:column>
							<p:column headerText="Prénom" exportable="true">
								<h:outputText />
							</p:column>
							<p:column headerText="Option" exportable="true">
								<h:outputText />
							</p:column>
						</p:dataTable>
					</c:if>
					<c:if test="#{surveyBean.selected.type eq 'OPINION'}">
						<c:forEach var="question" items="#{surveyBean.selected.questions}">
							<div class="col-md-6">
								<div class="box box-danger">
									<div class="box-header with-border">
										<h5>#{question.contenu}</h5>
									</div>
									<c:if test="#{question.parametres.writable}">
										<p:dataTable style="text-align:left !important; display: inline-block" styleClass="inputs" 
											value="#{question.listAnswers}" var="answer" paginator="true" rows="5">
											<p:column>
												<h:outputText value="#{answer.opinionText}"/>
											</p:column>
										</p:dataTable>
									</c:if>
									<c:if test="#{!question.parametres.severalAnswers and !question.parametres.writable}">
										<p:chart type="bar" style="height:300px" model="#{question.barModel}"/>
									</c:if>
								</div>
							</div>
						</c:forEach>
					</c:if>
					</div>
				</div>
				
			</section>
		</h:form>
	</ui:define>
</ui:composition>
</html>